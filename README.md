Sacumen Log Parser Assignment


Overview
This project is a Python script that parses system logs generated by an antivirus program. The logs follow a specific format and the script extracts key-value pairs, returning them as a dictionary.

Example Input Log:

SAC:0|Sacumen|CAAS|2021.2.0|3|MALICIOUS|High|cat=C2 cs1Label=subcat cs1=DNS_TUNNELING cs2Label=vueUrls cs2=https://aws-dev.sacdev.io/alerts?filter=alertId%3D%3D81650 cs3Label=Tags cs3=USA,Finance cs4Label=Url cs4=https://aws-dev.sacdev.io/settings/tir?rules.sort=4%3A1&filter=state%3D%3D2&selected=9739323 cn1Label=severityScore cn1=900 msg="Malicious activity was reported in CAAS= A threat intelligence rule has been automatically created in DAAS." dhost=bad.com dst=1.1.1.1

Expected Output:
{
    'cat': 'C2',
    'cs1Label': 'subcat',
    'cs1': 'DNS_TUNNELING',
    'cs2Label': 'vueUrls',
    'cs2': 'https://aws-dev.sacdev.io/alerts?filter=alertId%3D%3D81650',
    'cs3Label': 'Tags',
    'cs3': 'USA,Finance',
    'cs4Label': 'Url',
    'cs4': 'https://aws-dev.sacdev.io/settings/tir?rules.sort=4%3A1&filter=state%3D%3D2&selected=9739323',
    'cn1Label': 'severityScore',
    'cn1': '900',
    'msg': 'Malicious activity was reported in CAAS= A threat intelligence rule has been automatically created in DAAS.',
    'dhost': 'bad.com',
    'dst': '1.1.1.1'
}


Installation and Setup
Prerequisites
Python 3.x must be installed on your system.

Step-by-Step Guide
1.Clone or Download the Project:
    Download the ZIP file and extract it, or clone the repository using:

    git clone <repository_url>
    cd python-test


2. Create a Virtual Environment:
    Create a virtual environment to manage dependencies:
    python3 -m venv venv

    Activate the virtual environment:
        1. On Windows:
            .\venv\Scripts\activate

        2. On macOS/Linux:
            source venv/bin/activate

3. Install Dependencies:
    Install the required packages using pip:
    pip install -r requirements.txt

4. Running the Script
    To run the log parser script:

    python log_parser.py

    This will execute the script and display the parsed dictionary output for the given log string.


5. Running the Tests
    To ensure that everything is working correctly, you can run the unit tests using pytest:

    pytest --cov=log_parser --cov-report=term-missing

    This command will run the tests and provide a coverage report to ensure that at least 85% of the code is covered by tests.

Project Structure

├── log_parser.py          # Main script containing the log parser function
├── test_log_parser.py     # Unit tests for the log parser
├── requirements.txt       # Python dependencies
└── README.md              # This file
